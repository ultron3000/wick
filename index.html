<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cloud TV</title>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<style>
*{box-sizing:border-box;margin:0;padding:0;font-family:"Segoe UI",sans-serif;}
body{background:#0b0f14;color:#fff;}

/* HEADER */
header{
  display:flex;
  align-items:center;
  justify-content:space-between;
  background:#111;
  padding:10px 20px;
  box-shadow:0 5px 15px rgba(0,255,200,0.2);
}

header img{
  height:40px;
  border-radius:8px;
  margin-right:10px;
}

header h1{
  font-size:24px;
  font-weight:bold;
  color:#00ffcc;
  flex:1;
}

/* SEARCH */
#searchBar{
  padding:7px 12px;
  border-radius:20px;
  border:none;
  outline:none;
  font-size:14px;
  width:200px;
  background:#222;
  color:white;
  transition:0.2s;
}

#searchBar:focus{
  background:#333;
  box-shadow:0 0 8px #00ffcc;
}

/* CATEGORIES */
.categories{
  display:flex;
  gap:10px;
  padding:10px 15px;
  overflow-x:auto;
}

.categories button{
  background:#222;
  color:white;
  border:none;
  padding:8px 15px;
  border-radius:20px;
  cursor:pointer;
  transition:0.2s;
}

.categories button:hover{
  background:#00ffcc;
  color:black;
}

.categories button.active{
  background:#00ffcc;
  color:black;
}

/* GRID */
.grid{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(160px,1fr));
  gap:15px;
  padding:15px;
}

.card{
  background:#1a1a1a;
  border-radius:10px;
  overflow:hidden;
  cursor:pointer;
  transition:0.2s;
}

.card:hover{
  transform:scale(1.05);
}

.card img{
  width:100%;
  height:120px;
  object-fit:contain;
  background:#000;
}

.card h3{
  text-align:center;
  padding:10px;
  font-size:14px;
}

/* MODAL PLAYER */
.modal{
  position:fixed;
  top:0;
  left:0;
  width:100%;
  height:100%;
  background:rgba(0,0,0,0.95);
  display:none;
  justify-content:center;
  align-items:center;
  flex-direction:column;
  z-index:9999;
}

.close-btn{
  position:absolute;
  top:20px;
  right:25px;
  font-size:30px;
  cursor:pointer;
  color:white;
  transition:0.2s;
}

.close-btn:hover{
  color:#00ffcc;
}
</style>
</head>

<body>

<!-- HEADER -->
<header>
  <img src="https://static.readdy.ai/image/0ece273271e400e488b9947cb1e99e9a/a79b6f32c71c4ee2094ead0eb9c84c9b.png" alt="Cloud TV Logo">
  <h1>Cloud TV</h1>
  <input type="text" id="searchBar" placeholder="Search channels...">
</header>

<!-- CATEGORIES -->
<div class="categories" id="categories"></div>

<!-- GRID -->
<div class="grid" id="grid"></div>

<!-- PLAYER MODAL -->
<div class="modal" id="modal">
  <span class="close-btn" onclick="closePlayer()">âœ–</span>
  <iframe 
      id="videoFrame"
      allow="autoplay; fullscreen; encrypted-media; picture-in-picture"
      allowfullscreen
      referrerpolicy="no-referrer"
      style="width:90%;max-width:1100px;height:75vh;border:none;border-radius:12px;">
  </iframe>
</div>

<script>
let channels = [];
let currentGroup = "All";

// Load channels.json
async function loadChannels(){
  const res = await fetch("channels.json");
  channels = await res.json();
  renderCategories();
  renderChannels();
}

// Render categories
function renderCategories(){
  const groups = ["All", ...new Set(channels.map(c => c.group))];
  const container = document.getElementById("categories");
  container.innerHTML = "";
  groups.forEach(group=>{
    const btn = document.createElement("button");
    btn.textContent = group;
    if(group===currentGroup) btn.classList.add("active");
    btn.onclick = ()=>{
      currentGroup = group;
      renderCategories();
      renderChannels();
    };
    container.appendChild(btn);
  });
}

// Render channel cards
function renderChannels(){
  const grid = document.getElementById("grid");
  grid.innerHTML = "";
  const searchTerm = document.getElementById("searchBar").value.toLowerCase();

  channels
    .filter(c=> (currentGroup==="All"||c.group===currentGroup) && c.name.toLowerCase().includes(searchTerm))
    .forEach(ch=>{
      const card = document.createElement("div");
      card.className="card";
      card.innerHTML=`<img src="${ch.logo}"><h3>${ch.name}</h3>`;
      card.onclick=()=>play(ch.link);
      grid.appendChild(card);
    });
}

// Play video in modal
function play(url){
  document.getElementById("modal").style.display="flex";
  document.getElementById("videoFrame").src = url;
}

// Close player
function closePlayer(){
  document.getElementById("modal").style.display="none";
  document.getElementById("videoFrame").src = "";
}

// Search filter
document.getElementById("searchBar").addEventListener("input", renderChannels);

loadChannels();
</script>

</body>
</html>
